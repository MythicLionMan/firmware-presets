#$ TITLE: Standard Configuration
#$ FIRMWARE_VERSION: 4.3
#$ CATEGORY: OTHER
#$ STATUS: COMMUNITY
#$ KEYWORDS: personal, GPS
#$ AUTHOR: MythicLionMan
#$ DESCRIPTION: This is my 'standard' quad setup that I have on pretty much all of my rigs. All changes are optional, in nothing is selected nothing will happen.
#$ DESCRIPTION: Failsafe - configures failsafe (TODO I can't remember how its configured)
#$ DESCRIPTION: Radio Setup - Sets the min_check, max_check and min_throttle values to match the gimbals of my radio.
#$ DESCRIPTION: Radio Protocol - Configures the radio protocol, and optionally LQ emulation for CrSf.
#$ DESCRIPTION: Blackbox Tuning - Increases blackbox_p_ratio for improved resolution tuning when using PIDToolbox
#$ DESCRIPTION: Motor Protocol - Turns on DSHOT600 and sets the motor pwm rate.
#$ DESCRIPTION: GPS - Configures the GPS. RTH distance is set to 50m (the minimum) and sanity checks are disabled when possible. Arming without a fix is set to true.
#$ WARNING: DSHOT with the ESCs that don't support DSHOT is dangerous and can spin up the motors right away without arming.

#$ INCLUDE: presets/4.3/other/reset_gps.txt

# I grabbed this setup from my CLI dumps of the backups of Inky, Blinky and Clyde. I've tried to standardize to just the stuff I custom configure on all builds.

#$ OPTION BEGIN (CHECKED): Failsafe
# rxfail
rxfail 3 h
# (Only on Clyde)
rxfail 11 s 1000
#$ OPTION END


#$ OPTION BEGIN (CHECKED): Standard Features
# I have airmode on a switch, so I want it disabled by default
feature -AIRMODE
feature GPS
feature TELEMETRY
beeper -ON_USB
set small_angle = 180
#$ OPTION END


# Options specific to my radio
#$ OPTION BEGIN (CHECKED): Radio Setup
# Setting min_check to 1005 since my radio can handle a lower threshold
set min_check = 1005
set max_check = 1995
# Clyde was 1070, Blinky was 1023, Inky was 1070
set min_throttle = 1070
#$ OPTION END

#$ OPTION_GROUP BEGIN: Radio Protocol
#$ OPTION BEGIN (UNCHECKED): None
#$ OPTION END
#$ OPTION BEGIN (UNCHECKED): FrSky SBUS
    set serialrx_provider = SBUS
#$ OPTION END
#$ OPTION BEGIN (UNCHECKED): Crossfire
    set serialrx_provider = CRSF
#$ OPTION END
#$ OPTION BEGIN (CHECKED): Crossfire + DJI LQ
    set serialrx_provider = CRSF

    # Sets up CrSf RSSI for DJI Goggles by reading RSSI from a channel. This requires
    # setup on the crossfire receiver on the radio as well. Once I can properly report
    # LQ on the DJI OSD I can disable this hack.
    set rssi_channel = 12
#$ OPTION END
#$ OPTION_GROUP END

# Sets up blackbox for tuning
#$ OPTION BEGIN (UNCHECKED): Blackbox Tuning
set blackbox_p_ratio = 64
#$ OPTION END

#$ OPTION BEGIN (CHECKED): Motor Protocol
# On all
set dshot_bidir = ON
set use_unsynced_pwm = OFF
# Clyde DSHOT600, Blinky DSHOT300, Inky -
set motor_pwm_protocol = DSHOT600
# Clyde, Blinky = 480, Inky = -
set motor_pwm_rate = 480
#$ OPTION END

#$ OPTION BEGIN (CHECKED): GPS
# On all
set gps_provider = UBLOX
set gps_rescue_min_dth = 50
set gps_rescue_allow_arming_without_fix = ON
set gps_auto_baud = ON
# On Blinky & Inky
set gps_rescue_sanity_checks = RESCUE_SANITY_FS_ONLY
#$ OPTION END

# Only on blinky
#set pid_process_denom = 2
#set tlm_halfduplex = OFF


